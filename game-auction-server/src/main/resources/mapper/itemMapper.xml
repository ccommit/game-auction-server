<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ccommit.gameauctionserver.mapper.ItemMapper">

    <insert id="createItem" parameterType="com.ccommit.gameauctionserver.dto.Item">
        <selectKey keyProperty="id" order="AFTER" resultType="int">
            SELECT LAST_INSERT_ID()
        </selectKey>
        INSERT INTO item (   name
                            ,equipment_level
                            ,rating
                            ,main_type
                            ,sub_type
                            ,first_property
                            ,second_property
                            ,item_image_url
                            ,user_id
                            ,is_Exist )

        VALUE          (     #{name}
                            ,#{equipmentLevel}
                            ,#{rating}
                            ,#{mainType}
                            ,#{subType}
                            ,#{firstProperty}
                            ,#{secondProperty}
                            ,#{itemImageURL}
                            ,#{userId}
                            ,#{exist});
    </insert>

    <select id ="isUserItemId" resultType="java.lang.Integer">
        SELECT  i.id
        FROM    item i
        JOIN    user u ON i.user_id = u.id
        WHERE   i.id = #{itemId}
        AND     u.user_id = #{userId}
    </select>

    <select id ="readItem" resultType="com.ccommit.gameauctionserver.dto.Item">
        SELECT  id AS id,
                name AS name,
                equipment_level AS equipment_Level,
                rating AS rating,
                main_type AS mainType,
                sub_type AS subType,
                first_property AS firstProperty,
                second_property AS secondProperty,
                item_image_url AS itemImageURL,
                user_id AS userId,
                is_Exist AS exist
        FROM    item
        WHERE   id = #{itemId}
    </select>

</mapper>
